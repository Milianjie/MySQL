### 1、什么是索引

索引就相当于一本书的目录，通过目录可以快速的找到对应的资源

##### 在数据库中，查询一张表的时候有两种检索方式：

​		第一种：全表扫描

​		第二种：根据索引检索（效率高）

### 2、索引的原理

其最根本的原理是缩小了扫描的范围

```sql
索引虽然可以提高检索效率，但不能随意添加索引，因为索引在数据库中也是一个对象，需要数据库不断地维护，是有维护成本的。
数据库中经常被修改的数据的字段就不能添加索引，一旦数据被修改，索引就要重新排序进行维护
--添加索引说的是给某个字段或者说某些字段添加索引
```

### 3、创建索引对象和删除索引对象

```sql
创建索引对象：
	create index 索引对象名称 on 表名(字段名);
删除索引对象：
	drop index 索引对象名称 on 表名;
```



### 4、添加索引需满足的条件

当数据量庞大时，根据客户需求以及线上环境

该字段很少的DML操作

该字段经常出现在where子句中（经常根据哪个字段查询）

##### 注意：主键和具有unique约束的字段自动添加索引，根据主键查询的检索效率很高，尽量根据主键检索

--下面查看sql语句的执行计划

![](G:\BaiduNetdiskDownload\课堂笔记\课堂笔记\1.png)

从上图可以看出type属性是ALL，表明该查询是全文检索，rows=14，检索了14条

```sql
--给薪资字段添加索引,再查看执行计划
	create index emp_sal_index on emp(sal);
--从下图可以看出，type不再是全局检索，rows也只检索了一条就得出结果了
```

![](G:\BaiduNetdiskDownload\课堂笔记\课堂笔记\2.png)

##### 索引底层实现原理采用的是B Tree数据结构，如下图所示

![](G:\BaiduNetdiskDownload\课堂笔记\课堂笔记\索引实现原理.jpg)

假设我们将emp表中的ename字段添加索引，就会生成一个索引对象emp_ename_index存放到到硬盘文件或者是内存中，存到哪里看表的存储引擎类型。如右边红色部分即索引对象，索引会自动排序，这里是按字典顺序排，然后根据首字母的不同划分区，首字母相同第二字母不同有划分区，依次下去，当我们用where条件时根据输入值先按首字母定位区，依次定位下去，就大大减少了检索范围，由于数据库中每一行数据记录都有一个唯一的物理地址，Oracle中叫rowid，索引对象中的每个字段值也保留了，当where条件与索引某个值匹配上，就将该值的物理地址赋给sql语句中的where条件上，此时sql语句就是直接用该物理地址区查询该物理地址的那行记录，非常迅速。

##### 通过B Tree缩小扫描范围，底层索引进行了排序，分区；索引还会携带数据在表中的物理地址，最终是通过索引检索道数据之后获取其关联的物理地址，然后通过物理地址定位到表中的那一行数据，效率是最高的。

### 5、索引的分类

单一索引：给单个字段添加索引

复合索引：给多个字段联合起来添加一个索引

主键索引：主键上会自动添加索引

唯一索引：有unique约束的字段上自动添加索引

.....

##### 索引什么时候失效？

```sql
select ename from emp where ename like '%A%';
--即在模糊查询的时候，第一个通配符使用的是%，此时索引失效。因为第一个就是%，索引底层是没法找到是哪个分区的
```

